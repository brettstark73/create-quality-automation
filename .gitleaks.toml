# Gitleaks configuration for comprehensive secret detection
# Generated by create-qa-architect

[extend]
# Use default gitleaks rules as base
useDefault = true

# Additional custom patterns for common secrets
[[rules]]
description = "JWT tokens"
id = "jwt-token"
regex = '''eyJ[A-Za-z0-9_/+-]{10,}={0,2}'''
tags = ["key", "JWT"]

[[rules]]
description = "Base64 encoded secrets (long)"
id = "base64-secret"
regex = '''[A-Za-z0-9+/]{40,}={0,2}'''
tags = ["secret", "base64"]
keywords = ["secret", "key", "token", "password"]

[[rules]]
description = "Environment variable secrets"
id = "env-secret"
regex = '''(?i)(api_key|secret|password|token)\s*=\s*['""][^'"\s]{10,}['""]'''
tags = ["env", "secret"]

# Allowlist for test secrets in test files
[[allowlist]]
description = "Test secrets - test_secret pattern"
regex = '''test_secret_.*'''
paths = ['''tests/''', '''test/''', '''__tests__/''', '''examples/''', '''docs/''', '''.md$''']

[[allowlist]]
description = "Test secrets - example pattern"
regex = '''example_.*'''
paths = ['''tests/''', '''test/''', '''__tests__/''', '''examples/''', '''docs/''', '''.md$''']

[[allowlist]]
description = "Test secrets - dummy pattern"
regex = '''dummy_.*'''
paths = ['''tests/''', '''test/''', '''__tests__/''', '''examples/''', '''docs/''', '''.md$''']

[[allowlist]]
description = "Test secrets - fake pattern"
regex = '''fake_.*'''
paths = ['''tests/''', '''test/''', '''__tests__/''', '''examples/''', '''docs/''', '''.md$''']

# Global allowlist for common false positives
[[allowlist]]
description = "False positives - EXAMPLE pattern"
regex = '''EXAMPLE_.*'''

[[allowlist]]
description = "False positives - placeholder patterns"
regex = '''your_.*_here|replace_with_.*'''

[[allowlist]]
description = "False positives - TODO comments"
regex = '''TODO:.*'''
