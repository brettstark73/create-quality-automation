<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Create Quality Automation - Billing Dashboard</title>
    <script src="https://js.stripe.com/v3/"></script>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }
      body {
        font-family:
          -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        color: #333;
      }

      .container {
        max-width: 900px;
        margin: 0 auto;
        padding: 20px;
      }

      .header {
        text-align: center;
        color: white;
        margin-bottom: 40px;
      }

      .header h1 {
        font-size: 2.5rem;
        margin-bottom: 10px;
      }

      .header p {
        font-size: 1.2rem;
        opacity: 0.9;
      }

      .dashboard-card {
        background: white;
        border-radius: 12px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        padding: 30px;
        margin-bottom: 30px;
      }

      .tier-selector {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px;
        margin-bottom: 30px;
      }

      .tier-card {
        border: 2px solid #e1e5e9;
        border-radius: 12px;
        padding: 25px;
        text-align: center;
        cursor: pointer;
        transition: all 0.3s ease;
        position: relative;
      }

      .tier-card:hover {
        border-color: #667eea;
        transform: translateY(-5px);
        box-shadow: 0 10px 25px rgba(102, 126, 234, 0.15);
      }

      .tier-card.selected {
        border-color: #667eea;
        background: linear-gradient(135deg, #667eea10, #764ba210);
      }

      .tier-card.popular::before {
        content: 'MOST POPULAR';
        position: absolute;
        top: -10px;
        left: 50%;
        transform: translateX(-50%);
        background: linear-gradient(135deg, #667eea, #764ba2);
        color: white;
        padding: 5px 15px;
        border-radius: 20px;
        font-size: 0.8rem;
        font-weight: bold;
      }

      .tier-name {
        font-size: 1.5rem;
        font-weight: bold;
        margin-bottom: 10px;
        color: #333;
      }

      .tier-price {
        font-size: 2rem;
        font-weight: bold;
        color: #667eea;
        margin-bottom: 15px;
      }

      .tier-price .period {
        font-size: 1rem;
        color: #666;
      }

      .tier-features {
        text-align: left;
        margin-bottom: 20px;
      }

      .tier-features li {
        list-style: none;
        padding: 5px 0;
        position: relative;
        padding-left: 25px;
      }

      .tier-features li::before {
        content: '‚úÖ';
        position: absolute;
        left: 0;
      }

      .founder-discount {
        background: linear-gradient(135deg, #f093fb, #f5576c);
        color: white;
        padding: 15px;
        border-radius: 8px;
        margin: 20px 0;
        text-align: center;
      }

      .founder-discount h3 {
        margin-bottom: 10px;
      }

      .founder-discount .original-price {
        text-decoration: line-through;
        opacity: 0.7;
      }

      .founder-price {
        font-size: 1.5rem;
        font-weight: bold;
      }

      .checkout-btn {
        background: linear-gradient(135deg, #667eea, #764ba2);
        color: white;
        border: none;
        padding: 15px 30px;
        border-radius: 8px;
        font-size: 1.1rem;
        font-weight: bold;
        cursor: pointer;
        width: 100%;
        transition: all 0.3s ease;
      }

      .checkout-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
      }

      .checkout-btn:disabled {
        opacity: 0.6;
        cursor: not-allowed;
        transform: none;
      }

      .license-activation {
        border-top: 1px solid #e1e5e9;
        padding-top: 30px;
        margin-top: 30px;
      }

      .input-group {
        margin-bottom: 20px;
      }

      .input-group label {
        display: block;
        margin-bottom: 5px;
        font-weight: 600;
        color: #333;
      }

      .input-group input {
        width: 100%;
        padding: 12px;
        border: 2px solid #e1e5e9;
        border-radius: 6px;
        font-size: 1rem;
        transition: border-color 0.3s ease;
      }

      .input-group input:focus {
        outline: none;
        border-color: #667eea;
      }

      .activate-btn {
        background: #28a745;
        color: white;
        border: none;
        padding: 12px 25px;
        border-radius: 6px;
        font-weight: bold;
        cursor: pointer;
        transition: background 0.3s ease;
      }

      .activate-btn:hover {
        background: #218838;
      }

      .status-message {
        padding: 15px;
        border-radius: 6px;
        margin: 15px 0;
        font-weight: 500;
      }

      .status-success {
        background: #d4edda;
        color: #155724;
        border: 1px solid #c3e6cb;
      }

      .status-error {
        background: #f8d7da;
        color: #721c24;
        border: 1px solid #f5c6cb;
      }

      .loading {
        display: inline-block;
        width: 20px;
        height: 20px;
        border: 3px solid #f3f3f3;
        border-top: 3px solid #667eea;
        border-radius: 50%;
        animation: spin 1s linear infinite;
      }

      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }

      .features-comparison {
        display: grid;
        grid-template-columns: 2fr 1fr 1fr;
        gap: 15px;
        align-items: center;
        margin: 20px 0;
      }

      .features-comparison .feature-row {
        display: contents;
      }

      .features-comparison .feature-name {
        font-weight: 500;
        padding: 10px;
      }

      .features-comparison .feature-value {
        text-align: center;
        padding: 10px;
        background: #f8f9fa;
        border-radius: 4px;
      }

      .features-comparison .header-row {
        font-weight: bold;
        background: linear-gradient(135deg, #667eea, #764ba2);
        color: white;
        text-align: center;
        padding: 15px 10px;
        border-radius: 6px;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="header">
        <h1>Create Quality Automation</h1>
        <p>Choose your plan and start building quality software faster</p>
      </div>

      <div class="dashboard-card">
        <h2>üöÄ Choose Your Plan</h2>

        <div class="tier-selector">
          <!-- Pro Tier -->
          <div
            class="tier-card popular"
            data-tier="pro"
            onclick="selectTier('pro')"
          >
            <div class="tier-name">Pro</div>
            <div class="tier-price">$39<span class="period">/month</span></div>

            <div class="founder-discount">
              <h3>üéÅ Limited Founder Pricing</h3>
              <div class="original-price">$39/month</div>
              <div class="founder-price">$19.50/month</div>
              <div>Save 50% forever!</div>
            </div>

            <ul class="tier-features">
              <li>Framework-aware dependency grouping</li>
              <li>React, Vue, Angular ecosystem support</li>
              <li>60%+ reduction in dependency PRs</li>
              <li>Multi-language support (Python, Rust, Ruby)</li>
              <li>Priority email support</li>
              <li>Advanced security workflows</li>
            </ul>
          </div>

          <!-- Enterprise Tier -->
          <div
            class="tier-card"
            data-tier="enterprise"
            onclick="selectTier('enterprise')"
          >
            <div class="tier-name">Enterprise</div>
            <div class="tier-price">$197<span class="period">/month</span></div>

            <div class="founder-discount">
              <h3>üéÅ Limited Founder Pricing</h3>
              <div class="original-price">$197/month</div>
              <div class="founder-price">$98.50/month</div>
              <div>Save 50% forever!</div>
            </div>

            <ul class="tier-features">
              <li>Everything in Pro</li>
              <li>Priority support (24h response)</li>
              <li>Custom integrations</li>
              <li>Advanced analytics</li>
              <li>Team management features</li>
              <li>SLA guarantees</li>
            </ul>
          </div>
        </div>

        <div class="features-comparison">
          <div class="header-row">Features</div>
          <div class="header-row">Pro</div>
          <div class="header-row">Enterprise</div>

          <div class="feature-row">
            <div class="feature-name">Framework Grouping</div>
            <div class="feature-value">‚úÖ</div>
            <div class="feature-value">‚úÖ</div>
          </div>

          <div class="feature-row">
            <div class="feature-name">Multi-language Support</div>
            <div class="feature-value">‚úÖ</div>
            <div class="feature-value">‚úÖ</div>
          </div>

          <div class="feature-row">
            <div class="feature-name">Priority Support</div>
            <div class="feature-value">48h</div>
            <div class="feature-value">24h</div>
          </div>

          <div class="feature-row">
            <div class="feature-name">Custom Integrations</div>
            <div class="feature-value">‚ùå</div>
            <div class="feature-value">‚úÖ</div>
          </div>

          <div class="feature-row">
            <div class="feature-name">Team Analytics</div>
            <div class="feature-value">‚ùå</div>
            <div class="feature-value">‚úÖ</div>
          </div>
        </div>

        <button
          class="checkout-btn"
          onclick="startCheckout()"
          id="checkout-btn"
          disabled
        >
          Select a plan above
        </button>

        <div class="license-activation">
          <h3>üîë Already have a license key?</h3>
          <p>
            Enter your license key from the Stripe purchase confirmation email.
          </p>

          <div class="input-group">
            <label for="license-key">License Key</label>
            <input
              type="text"
              id="license-key"
              placeholder="CQA-XXXX-XXXX-XXXX-XXXX"
            />
          </div>

          <div class="input-group">
            <label for="email">Email Address</label>
            <input type="email" id="email" placeholder="your@email.com" />
          </div>

          <button class="activate-btn" onclick="activateLicense()">
            Activate License
          </button>

          <div id="activation-status"></div>
        </div>
      </div>
    </div>

    <script>
      const stripe = Stripe('pk_test_your_stripe_publishable_key_here') // Replace with actual key
      let selectedTier = null
      let isFounder = true // Enable founder pricing

      function selectTier(tier) {
        selectedTier = tier

        // Update UI
        document.querySelectorAll('.tier-card').forEach(card => {
          card.classList.remove('selected')
        })

        document
          .querySelector(`[data-tier="${tier}"]`)
          .classList.add('selected')

        // Enable checkout button
        const checkoutBtn = document.getElementById('checkout-btn')
        checkoutBtn.disabled = false

        if (tier === 'pro') {
          checkoutBtn.textContent = isFounder
            ? 'Start Pro Subscription - $19.50/month (Founder Price)'
            : 'Start Pro Subscription - $39/month'
        } else if (tier === 'enterprise') {
          checkoutBtn.textContent = isFounder
            ? 'Start Enterprise Subscription - $98.50/month (Founder Price)'
            : 'Start Enterprise Subscription - $197/month'
        }
      }

      async function startCheckout() {
        if (!selectedTier) return

        const checkoutBtn = document.getElementById('checkout-btn')
        checkoutBtn.disabled = true
        checkoutBtn.innerHTML =
          '<span class="loading"></span> Creating checkout session...'

        try {
          // Call your backend to create Stripe checkout session
          const response = await fetch('/api/create-checkout-session', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
            },
            body: JSON.stringify({
              tier: selectedTier.toUpperCase(),
              isFounder: isFounder,
              successUrl: window.location.origin + '/success',
              cancelUrl: window.location.origin + '/billing',
            }),
          })

          const session = await response.json()

          if (session.error) {
            throw new Error(session.error)
          }

          // Redirect to Stripe Checkout
          const result = await stripe.redirectToCheckout({
            sessionId: session.sessionId,
          })

          if (result.error) {
            throw new Error(result.error.message)
          }
        } catch (error) {
          console.error('Checkout error:', error)
          showStatus(
            'activation-status',
            `Checkout error: ${error.message}`,
            'error'
          )
        } finally {
          checkoutBtn.disabled = false
          if (selectedTier === 'pro') {
            checkoutBtn.textContent = isFounder
              ? 'Start Pro Subscription - $19.50/month (Founder Price)'
              : 'Start Pro Subscription - $39/month'
          } else {
            checkoutBtn.textContent = isFounder
              ? 'Start Enterprise Subscription - $98.50/month (Founder Price)'
              : 'Start Enterprise Subscription - $197/month'
          }
        }
      }

      async function activateLicense() {
        const licenseKey = document.getElementById('license-key').value.trim()
        const email = document.getElementById('email').value.trim()

        if (!licenseKey || !email) {
          showStatus(
            'activation-status',
            'Please enter both license key and email address.',
            'error'
          )
          return
        }

        try {
          showStatus('activation-status', 'Activating license...', 'loading')

          // Call your backend to activate license
          const response = await fetch('/api/activate-license', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
            },
            body: JSON.stringify({
              licenseKey: licenseKey,
              email: email,
            }),
          })

          const result = await response.json()

          if (result.success) {
            showStatus(
              'activation-status',
              `‚úÖ License activated successfully! Tier: ${result.tier}${result.isFounder ? ' (Founder)' : ''}`,
              'success'
            )

            // Clear form
            document.getElementById('license-key').value = ''
            document.getElementById('email').value = ''
          } else {
            throw new Error(result.error)
          }
        } catch (error) {
          console.error('Activation error:', error)
          showStatus(
            'activation-status',
            `Activation failed: ${error.message}`,
            'error'
          )
        }
      }

      function showStatus(elementId, message, type) {
        const statusEl = document.getElementById(elementId)
        statusEl.className = `status-message ${type === 'error' ? 'status-error' : type === 'success' ? 'status-success' : ''}`
        statusEl.textContent = message
      }

      // Initialize page
      document.addEventListener('DOMContentLoaded', function () {
        // Check for success/error parameters in URL
        const urlParams = new URLSearchParams(window.location.search)

        if (urlParams.get('success')) {
          showStatus(
            'activation-status',
            '‚úÖ Payment successful! Check your email for license activation instructions.',
            'success'
          )
        }

        if (urlParams.get('canceled')) {
          showStatus(
            'activation-status',
            'Payment was canceled. You can try again anytime.',
            'error'
          )
        }

        // Pre-select Pro tier as most popular
        selectTier('pro')
      })
    </script>
  </body>
</html>
